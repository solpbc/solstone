{% extends 'base.html' %}
{% import 'macros.html' as macros %}
{% set active = 'calendar' %}
{% block head %}
<style>
body{font-family:sans-serif;margin:0;}
.container{max-width:800px;margin:0 auto;padding:1em;}
.tabs{border-bottom:2px solid #e0e0e0;margin-bottom:1em;}
.tab{display:inline-block;padding:8px 12px;margin-right:4px;background:#f5f5f5;border:1px solid #ddd;border-bottom:none;cursor:pointer;border-radius:4px 4px 0 0;}
.tab.active{background:white;font-weight:bold;}
.content{border:1px solid #ddd;padding:1em;}
</style>
{% endblock %}
{% block body %}
<div class="container">
  {{ macros.day_heading(title,
        prev_day and url_for('calendar.calendar_day', day=prev_day),
        next_day and url_for('calendar.calendar_day', day=next_day)) }}
  <div class="tabs">
    {% for file in files %}
    <a class="tab{% if loop.first %} active{% endif %}" href="#{{ file.slug }}" data-target="{{ file.slug }}">{{ file.label }}</a>
    {% endfor %}
    <a class="tab" href="{{ url_for('admin.admin_day_page', day=day) }}" title="Admin" aria-label="Admin" style="font-size:20px">⚙️</a>
  </div>
  {% for file in files %}
  <div class="content" id="{{ file.slug }}" style="{% if not loop.first %}display:none{% endif %}">
    <div class="markdown">{{ file.html|safe }}</div>
  </div>
  {% endfor %}
</div>
<script>
const tabs = document.querySelectorAll('.tab');
const contents = document.querySelectorAll('.content');

function showTab(id){
  tabs.forEach(x=>x.classList.remove('active'));
  contents.forEach(c=>c.style.display='none');
  const tab = document.querySelector(`.tab[data-target="${id}"]`);
  const content = document.getElementById(id);
  if(tab) tab.classList.add('active');
  if(content) content.style.display='block';
  if(history.replaceState){
    history.replaceState(null, '', '#' + id);
  } else {
    location.hash = '#' + id;
  }
}

tabs.forEach(t=>t.addEventListener('click', e=>{e.preventDefault();showTab(t.dataset.target);}));
const initial = location.hash.slice(1);
if(initial && document.getElementById(initial)){
  showTab(initial);
}
</script>
{% endblock %}
